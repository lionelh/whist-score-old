{"ast":null,"code":"import { FormControl, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/navigation-notification.service\";\nimport * as i2 from \"../../services/data.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/router\";\n\nfunction HomeComponent_tr_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2, \"Aucune partie trouv\\u00E9e !\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"colspan\", 5);\n  }\n}\n\nfunction HomeComponent_tr_26_span_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 32);\n    i0.ɵɵtext(1, \"Nouvelle\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction HomeComponent_tr_26_span_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 33);\n    i0.ɵɵtext(1, \"En cours\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction HomeComponent_tr_26_span_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1, \"Termin\\u00E9e\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction HomeComponent_tr_26_li_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 35);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const p_r12 = ctx.$implicit;\n    const j_r13 = ctx.index;\n    i0.ɵɵclassProp(\"bg-warning\", j_r13 % 2 == 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(p_r12.name);\n  }\n}\n\nfunction HomeComponent_tr_26_a_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"a\", 36);\n    i0.ɵɵlistener(\"click\", function HomeComponent_tr_26_a_17_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const e_r6 = i0.ɵɵnextContext().$implicit;\n      const ctx_r14 = i0.ɵɵnextContext();\n      return ctx_r14.closeEvent(e_r6 == null ? null : e_r6.id);\n    });\n    i0.ɵɵelement(1, \"i\", 37);\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function (a1) {\n  return [\"/games\", a1];\n};\n\nfunction HomeComponent_tr_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtemplate(7, HomeComponent_tr_26_span_7_Template, 2, 0, \"span\", 23);\n    i0.ɵɵtemplate(8, HomeComponent_tr_26_span_8_Template, 2, 0, \"span\", 24);\n    i0.ɵɵtemplate(9, HomeComponent_tr_26_span_9_Template, 2, 0, \"span\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\")(11, \"ul\", 26);\n    i0.ɵɵtemplate(12, HomeComponent_tr_26_li_12_Template, 2, 3, \"li\", 27);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"td\", 28)(14, \"a\", 29);\n    i0.ɵɵelement(15, \"i\", 30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16, \" \\u00A0 \");\n    i0.ɵɵtemplate(17, HomeComponent_tr_26_a_17_Template, 2, 0, \"a\", 31);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const e_r6 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(3, 8, e_r6.eventDate, \"dd MMMM YYYY\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(e_r6.place);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", e_r6.status == \"NEW\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", e_r6.status == \"IN_PROGRESS\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", e_r6.status == \"FINISHED\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", e_r6.players);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(11, _c0, e_r6.id));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", (e_r6 == null ? null : e_r6.status) == \"IN_PROGRESS\");\n  }\n}\n\nfunction HomeComponent_div_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 38);\n    i0.ɵɵtext(1, \" Validation en cours... \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction HomeComponent_div_41_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Le lieu est obligatoire.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction HomeComponent_div_41_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Le lieu doit contenir au moins 2 caract\\u00E8res.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction HomeComponent_div_41_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Le lieu doit comporter maximum 150 caract\\u00E8res.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction HomeComponent_div_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtemplate(1, HomeComponent_div_41_div_1_Template, 2, 0, \"div\", 9);\n    i0.ɵɵtemplate(2, HomeComponent_div_41_div_2_Template, 2, 0, \"div\", 9);\n    i0.ɵɵtemplate(3, HomeComponent_div_41_div_3_Template, 2, 0, \"div\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.place == null ? null : ctx_r3.place.errors == null ? null : ctx_r3.place.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.place == null ? null : ctx_r3.place.errors == null ? null : ctx_r3.place.errors[\"minlength\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.place == null ? null : ctx_r3.place.errors == null ? null : ctx_r3.place.errors[\"maxlength\"]);\n  }\n}\n\nfunction HomeComponent_div_45_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 40)(1, \"input\", 41);\n    i0.ɵɵlistener(\"change\", function HomeComponent_div_45_Template_input_change_1_listener($event) {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return ctx_r21.onPlayerCheckboxChange($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"label\", 42);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const p_r20 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"value\", p_r20.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r20.name);\n  }\n}\n\nfunction HomeComponent_div_46_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtext(1, \" La s\\u00E9lection des joueurs participants est obligatoire. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let HomeComponent = /*#__PURE__*/(() => {\n  class HomeComponent {\n    constructor(_navigationNotifierService, _dataService, _fb) {\n      this._navigationNotifierService = _navigationNotifierService;\n      this._dataService = _dataService;\n      this._fb = _fb;\n      this.creationForm = this._fb.group({\n        place: ['', [Validators.required, Validators.minLength(2), Validators.maxLength(150)], [], {\n          updateOn: \"blur\"\n        }],\n        players: this._fb.array([], [Validators.required])\n      });\n    }\n\n    ngOnInit() {\n      this._navigationNotifierService.announcePageChange('home');\n\n      this.events$ = this._dataService.findAllEvents();\n\n      this._dataService.findAllPlayers().subscribe(data => {\n        this.dbPlayers = data;\n      });\n    }\n\n    get place() {\n      return this.creationForm.get('place');\n    }\n\n    get players() {\n      return this.creationForm.get('players');\n    }\n\n    onSubmit() {\n      var _a;\n\n      if ((_a = this.creationForm) === null || _a === void 0 ? void 0 : _a.valid) {\n        let e = {\n          place: this.creationForm.value['place']\n        };\n        e.players = [];\n        const playersTab = this.creationForm.get('players');\n        playersTab.controls.forEach(item => {\n          var _a;\n\n          let roleId = item.value;\n          let p = this.findPlayerById(roleId);\n\n          if (p !== undefined) {\n            (_a = e.players) === null || _a === void 0 ? void 0 : _a.push(p);\n          }\n        });\n\n        this._dataService.createEvent(e).subscribe(() => {\n          this.events$ = this._dataService.findAllEvents();\n        });\n\n        this.creationForm.reset();\n        this.players.clear();\n      }\n    }\n\n    findPlayerById(inId) {\n      var _a;\n\n      let found = undefined;\n      (_a = this.dbPlayers) === null || _a === void 0 ? void 0 : _a.forEach(item => {\n        if (item.id == inId) {\n          found = item;\n        }\n      });\n      return found;\n    }\n\n    onPlayerCheckboxChange(e) {\n      let eventTarget = e.target;\n      const playersArray = this.creationForm.get('players');\n\n      if (eventTarget.checked) {\n        playersArray.push(new FormControl(eventTarget.value));\n      } else {\n        let i = 0;\n        playersArray.controls.forEach(item => {\n          if (item.value == (eventTarget === null || eventTarget === void 0 ? void 0 : eventTarget.value)) {\n            playersArray.removeAt(i);\n            return;\n          }\n\n          i++;\n        });\n      }\n    }\n\n    closeEvent(inId) {\n      this._dataService.closeEvent(inId).subscribe(() => {\n        this.events$ = this._dataService.findAllEvents();\n      });\n    }\n\n  }\n\n  HomeComponent.ɵfac = function HomeComponent_Factory(t) {\n    return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.NavigationNotifierService), i0.ɵɵdirectiveInject(i2.DataService), i0.ɵɵdirectiveInject(i3.FormBuilder));\n  };\n\n  HomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HomeComponent,\n    selectors: [[\"wsw-home\"]],\n    decls: 51,\n    vars: 18,\n    consts: [[1, \"container\"], [1, \"row\"], [1, \"col\"], [1, \"card\", \"text-white\", \"border-primary\"], [1, \"card-header\", \"bg-primary\"], [1, \"card-body\"], [1, \"card-text\"], [1, \"table\", \"table-bordered\"], [1, \"bg-primary\", \"text-white\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [1, \"card-body\", \"text-black\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\", \"required\"], [\"for\", \"place\", 1, \"control-label\"], [\"id\", \"place\", \"type\", \"text\", \"formControlName\", \"place\", 1, \"form-control\"], [1, \"form-helper\"], [\"class\", \"text-warning\", 4, \"ngIf\"], [\"class\", \"invalid-feedback\", 4, \"ngIf\"], [\"for\", \"roles\", 1, \"control-label\"], [\"class\", \"form-check\", 4, \"ngFor\", \"ngForOf\"], [1, \"form-group\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [\"class\", \"badge rounded-pill bg-danger\", 4, \"ngIf\"], [\"class\", \"badge rounded-pill bg-warning\", 4, \"ngIf\"], [\"class\", \"badge rounded-pill bg-success\", 4, \"ngIf\"], [1, \"list-group\"], [\"class\", \"list-group-item\", 3, \"bg-warning\", 4, \"ngFor\", \"ngForOf\"], [1, \"text-black\"], [\"title\", \"Voir les d\\u00E9tails de la partie\", 1, \"btn\", \"btn-success\", \"bg-success\", 3, \"routerLink\"], [1, \"bi-search\"], [\"title\", \"Cl\\u00F4turer la partie\", \"class\", \"btn btn-danger bg-danger\", 3, \"click\", 4, \"ngIf\"], [1, \"badge\", \"rounded-pill\", \"bg-danger\"], [1, \"badge\", \"rounded-pill\", \"bg-warning\"], [1, \"badge\", \"rounded-pill\", \"bg-success\"], [1, \"list-group-item\"], [\"title\", \"Cl\\u00F4turer la partie\", 1, \"btn\", \"btn-danger\", \"bg-danger\", 3, \"click\"], [1, \"bi-trash\"], [1, \"text-warning\"], [1, \"invalid-feedback\"], [1, \"form-check\"], [\"type\", \"checkbox\", 1, \"form-check-input\", 3, \"value\", \"change\"], [1, \"form-check-label\"]],\n    template: function HomeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h1\");\n        i0.ɵɵtext(4, \"Bienvenue !\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(5, \"div\", 1)(6, \"div\", 2)(7, \"div\", 3)(8, \"div\", 4);\n        i0.ɵɵtext(9, \"Historique des parties\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 5)(11, \"div\", 6)(12, \"table\", 7)(13, \"tr\", 8)(14, \"th\");\n        i0.ɵɵtext(15, \"Date de la partie\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"th\");\n        i0.ɵɵtext(17, \"Lieu de la partie\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"th\");\n        i0.ɵɵtext(19, \"Status de la partie\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"th\");\n        i0.ɵɵtext(21, \"Joeurs participants\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"th\");\n        i0.ɵɵtext(23, \"\\u00A0\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(24, HomeComponent_tr_24_Template, 3, 1, \"tr\", 9);\n        i0.ɵɵpipe(25, \"async\");\n        i0.ɵɵtemplate(26, HomeComponent_tr_26_Template, 18, 13, \"tr\", 10);\n        i0.ɵɵpipe(27, \"async\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(28, \"div\", 2)(29, \"div\", 3)(30, \"div\", 4);\n        i0.ɵɵtext(31, \"Cr\\u00E9ation d'une partie\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"div\", 11)(33, \"div\", 6)(34, \"form\", 12);\n        i0.ɵɵlistener(\"ngSubmit\", function HomeComponent_Template_form_ngSubmit_34_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(35, \"div\", 13)(36, \"label\", 14);\n        i0.ɵɵtext(37, \"Lieu de la partie\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(38, \"input\", 15)(39, \"div\", 16);\n        i0.ɵɵtemplate(40, HomeComponent_div_40_Template, 2, 0, \"div\", 17);\n        i0.ɵɵtemplate(41, HomeComponent_div_41_Template, 4, 3, \"div\", 18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(42, \"div\", 13)(43, \"label\", 19);\n        i0.ɵɵtext(44, \"Joueurs participants \\u00E0 la partie\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(45, HomeComponent_div_45_Template, 4, 2, \"div\", 20);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(46, HomeComponent_div_46_Template, 2, 0, \"div\", 18);\n        i0.ɵɵelementStart(47, \"div\", 21)(48, \"fieldset\")(49, \"button\", 22);\n        i0.ɵɵtext(50, \"Enregistrer\");\n        i0.ɵɵelementEnd()()()()()()()()()();\n      }\n\n      if (rf & 2) {\n        let tmp_0_0;\n        i0.ɵɵadvance(24);\n        i0.ɵɵproperty(\"ngIf\", ((tmp_0_0 = i0.ɵɵpipeBind1(25, 14, ctx.events$)) == null ? null : tmp_0_0.length) == 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(27, 16, ctx.events$));\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"formGroup\", ctx.creationForm);\n        i0.ɵɵadvance(1);\n        i0.ɵɵclassProp(\"has-danger\", (ctx.place == null ? null : ctx.place.invalid) && ((ctx.place == null ? null : ctx.place.dirty) || (ctx.place == null ? null : ctx.place.touched)));\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"is-invalid\", (ctx.place == null ? null : ctx.place.invalid) && ((ctx.place == null ? null : ctx.place.dirty) || (ctx.place == null ? null : ctx.place.touched)))(\"is-valid\", (ctx.place == null ? null : ctx.place.valid) && ((ctx.place == null ? null : ctx.place.dirty) || (ctx.place == null ? null : ctx.place.touched)));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ((ctx.place == null ? null : ctx.place.dirty) || (ctx.place == null ? null : ctx.place.touched)) && (ctx.place == null ? null : ctx.place.status) === \"PENDING\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", (ctx.place == null ? null : ctx.place.invalid) && ((ctx.place == null ? null : ctx.place.dirty) || (ctx.place == null ? null : ctx.place.touched)));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.dbPlayers);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.creationForm.controls[\"players\"].errors == null ? null : ctx.creationForm.controls[\"players\"].errors[\"required\"]);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", !(ctx.creationForm == null ? null : ctx.creationForm.valid));\n      }\n    },\n    directives: [i4.NgIf, i4.NgForOf, i5.RouterLinkWithHref, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.DefaultValueAccessor, i3.NgControlStatus, i3.FormControlName],\n    pipes: [i4.AsyncPipe, i4.DatePipe],\n    styles: [\"\"]\n  });\n  return HomeComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}